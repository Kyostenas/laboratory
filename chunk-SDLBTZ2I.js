import{$a as _e,Aa as le,Ca as C,G as ee,H as te,L as H,Ma as g,Na as o,Oa as r,P as ie,Pa as d,Ta as de,Ua as F,W as N,Wa as P,X as z,Xa as B,Ya as G,Za as j,_a as x,ab as l,bb as b,ca as S,cb as V,f as D,ha as ne,j as k,jb as me,n as $,oa as v,qa as oe,ra as re,sa as ae,t as J,ta as f,tb as he,xa as se,z as K,za as ce}from"./chunk-C5IEL3DF.js";import{a as M}from"./chunk-2NFLSA4Y.js";var R=class c{constructor(e){this.rendererFactory=e;this.renderer2=this.rendererFactory.createRenderer(null,null)}active_containers=new Map;renderer2;register_container(e){let t=e.HTML_container,i=e.HTML_host,n=this.active_containers.get(i?.closest(".floating-container")?.id??"");for(;;){let a=i?.closest(".floating-container");if(a){let s=this.active_containers.get(a.id);if(s){if(s.children)break;t&&(s.children=[{element:t,directive:e}]),this.active_containers.set(s.element.id,s),i=e.HTML_host;break}else break}else break}t?.id&&this.active_containers.set(t.id,{element:t,directive:e,parent:n?{element:n.element,directive:n.directive}:void 0})}unregister_container(e){let t=this.active_containers.get(e.container_id);this.active_containers.delete(e.container_id);let i=t?.parent;for(;i;){let n=i.directive.container_id,a=this.active_containers.get(n);a?.children&&(a.children=a?.children?.filter(s=>s.directive.container_id!==n),this.active_containers.set(n,a)),i=a?.parent}}send_should_keep_open_signal(e){let t=e.container_id,n=this.active_containers.get(t)?.parent;for(;n;){n.directive.should_keep_open$.next();let a=n.directive.container_id;n=this.active_containers.get(a)?.parent}}send_should_close_signal(e){let t=e.container_id,i=this.active_containers.get(t);for(let a of i?.children??[])a.directive.should_close$.next();let n=i?.parent;for(;n;){n.directive.should_close$.next();let a=n.directive.container_id;n=this.active_containers.get(a)?.parent}}close_all_containers(){for(let[e,t]of this.active_containers.entries())t.directive.close_container(),this.active_containers.delete(e)}close_container_by_id(e){let t=this.active_containers.get(e),i=t?.directive;i&&(this.send_should_close_signal(i),t?.directive?.close_container())}static \u0275fac=function(t){return new(t||c)(ie(re))};static \u0275prov=H({token:c,factory:c.\u0275fac,providedIn:"root"})};var pe=991,U=1.5,X=3.5,I=.25,be="fit-content",E="bottom",T=5,Ee=400,A=class c{constructor(e,t,i,n){this.renderer2=e;this.element_ref=t;this.cdr=i;this.floating_container_service=n}set _container_data(e){setTimeout(()=>{this.container_data=M(M({},this.container_data),e)},0)}destroyed_emitter=new C;mouse_enter_container_emitter=new C;mouse_leave_container_emitter=new C;ngOnInit(){this.container_id="_"+Math.round(Math.random()*1e8),this.evaluate_screen_mode(),this.HTML_host=this.element_ref.nativeElement,this.renderer2.addClass(this.HTML_host,"floating-containers-host")}ngOnDestroy(){console.log("destroy"),this.close_container()}container_data={size:be,min_height:`${U}rem`,min_width:`${X}rem`,header_padding:`${I}rem`,body_padding:`${I}rem`,footer_padding:`${I}rem`,full_screen_breakpoint:pe,placement:E};screen_mode="mobile-tablet";container_id;container_visible=!1;HTML_document_body=document.body;HTML_host;HTML_backdrop;HTML_container;HTML_header;HTML_body;HTML_footer;EMBEDDED_header;EMBEDDED_body;EMBEDDED_footer;should_keep_open$=new D;should_close$=new D;closed$=new D;unlisten_enter;unlisten_leave;unlisten_window_scroll;unlisten_window_resize;resize_observer;on_window_resize=()=>{this.evaluate_screen_mode(),this.positionate_container(this.container_data.placement??E)};on_window_scroll=()=>{this.evaluate_screen_mode(),this.positionate_container(this.container_data.placement??E)};on_click(e){this.toggle_container()}on_mouse_enter_host(){let e=!!document.getElementById(this.container_id);this.container_visible&&e&&this.HTML_container||this.create_container(),this.should_keep_open$.next()}on_mouse_leave_host(){this.should_close$.next()}on_mouse_enter_container=()=>{this.mouse_enter_container_emitter.emit(),this.should_keep_open$.next(),this.floating_container_service.send_should_keep_open_signal(this)};on_mouse_leave_container=()=>{this.mouse_leave_container_emitter.emit(),this.should_close$.next(),this.floating_container_service.send_should_close_signal(this)};on_container_resize=e=>{this.positionate_container(this.container_data?.placement??E)};prepare_container_listeners(){this.unlisten_enter=this.renderer2.listen(this.HTML_container,"mouseenter",this.on_mouse_enter_container),this.unlisten_leave=this.renderer2.listen(this.HTML_container,"mouseleave",this.on_mouse_leave_container),this.unlisten_window_scroll=this.renderer2.listen("window","scroll",this.on_window_scroll),this.unlisten_window_resize=this.renderer2.listen("window","resize",this.on_window_resize),this.resize_observer=new ResizeObserver(this.on_container_resize),this.HTML_container&&this.resize_observer.observe(this.HTML_container);let e=this.should_keep_open$.pipe($(()=>!0)),t=this.should_close$.pipe($(()=>!1));J(e,t).pipe(ee(i=>i?k(!0):k(!1).pipe(K(Ee))),te(this.closed$)).subscribe(i=>{if(!i){let n=!!document.getElementById(this.container_id);this.container_visible&&n&&this.HTML_container&&this.close_container()}})}stop_listeining_events(){this.unlisten_enter&&this.unlisten_enter(),this.unlisten_leave&&this.unlisten_leave(),this.unlisten_window_resize&&this.unlisten_window_resize(),this.unlisten_window_scroll&&this.unlisten_window_scroll(),this.resize_observer&&this.resize_observer.disconnect(),this.closed$.next(),this.closed$.complete()}evaluate_screen_mode(){window.innerWidth<(this.container_data.full_screen_breakpoint??pe)?this.screen_mode="mobile-tablet":this.screen_mode="desktop",this.screen_mode==="mobile-tablet"?this.container_data.full_screen=!0:this.container_data.full_screen=!1}assign_styles_to_element(e,t){for(let[i,n]of Object.entries(t))this.renderer2.setStyle(e,i,n)}remove_styles_of_element(e,t){for(let i of t)this.renderer2.removeStyle(e,i)}assign_properties_to_element(e,t){for(let[i,n]of Object.entries(t))this.renderer2.setAttribute(e,i,n)}remove_properties_of_element(e,t){for(let i of t)this.renderer2.removeAttribute(e,i)}assign_classes_to_element(e,t){for(let i of t)this.renderer2.addClass(e,i)}remove_classes_of_element(e,t){for(let i of t)this.renderer2.removeClass(e,i)}get_current_font_size(){let e=window.getComputedStyle(this.HTML_document_body);return parseFloat(e.fontSize)}toggle_container(){let e=!!document.getElementById(this.container_id);this.container_visible&&e&&this.HTML_container?this.close_container():this.create_container()}close_container(){this.renderer2.removeChild(this.HTML_document_body,this.HTML_container),this.container_visible=!1,this.stop_listeining_events(),this.destroyed_emitter.emit(),this.floating_container_service.unregister_container(this)}create_container(){this.HTML_container=this.renderer2.createElement("div"),this.HTML_container&&this.assign_classes_to_element(this.HTML_container,["floating-container"]),this.prepare_container_listeners(),this.HTML_container&&(this.assign_styles_to_element(this.HTML_container,M({isolation:"isolate",position:"fixed",contain:"layout","text-wrap":"wrap","z-index":"100","backdrop-filter":"blur(15px)",background:"rgba(0, 0, 0, .2)",color:"white","box-shadow":"0px 4px 8px rgba(0, 0, 0, 0.3)",top:"0",left:"0","min-height":this.container_data.min_height??`${U}rem`,"min-width":this.container_data.min_width??`${X}rem`,padding:this.container_data.body_padding??`${I}rem`,overflow:"auto","border-radius":".5rem"},this.container_data?.container_css_styles)),this.assign_properties_to_element(this.HTML_container,{id:this.container_id})),this.HTML_body=this.renderer2.createElement("div"),typeof this.container_data?.body_content=="string"?(this.renderer2.setProperty(this.HTML_body,"innerHTML",this.container_data.body_content),this.HTML_body&&this.assign_styles_to_element(this.HTML_body,{"white-space":"pre-wrap"})):this.container_data?.body_content instanceof oe&&(this.EMBEDDED_body=this.container_data.body_content.createEmbeddedView(this.container_data.template_context||{}),this.EMBEDDED_body.rootNodes.forEach(e=>{this.renderer2.appendChild(this.HTML_body,e)}),this.EMBEDDED_body.detectChanges()),this.renderer2.appendChild(this.HTML_container,this.HTML_body),this.renderer2.appendChild(this.HTML_document_body,this.HTML_container),this.positionate_container(this.container_data?.placement??E),this.cdr?.detectChanges(),this.container_visible=!0,this.floating_container_service.register_container(this)}check_screen_bounds(e,t){let i=this.HTML_container?.getBoundingClientRect(),n=0,a=0,s=!1;return(i?.top??0)<0&&(e==="top"?(s=!0,t>1?e="left":e="bottom"):n=i?.top??0),(i?.left??0)<0&&(e==="left"?(s=!0,e="right"):a=i?.left??0),(i?.right??0)>window.innerWidth&&(e==="right"?(s=!0,e="left"):a=window.innerWidth-(i?.right??0)),(i?.bottom??0)>window.innerHeight&&(e==="bottom"?(s=!0,t>1?e="left":e="top"):n=window.innerHeight-(i?.bottom??0)),{top_correction:n,left_correction:a,recalculate:s,placement:e}}positionate_container(e,t=0,i=0,n=0){let a=this.HTML_host?.getBoundingClientRect(),s=this.HTML_container?.offsetHeight,Q=this.HTML_container?.offsetWidth,u=window.innerHeight,y=window.innerWidth,_=0,m=0,p=0,h=0,w=0,L=0;switch(e){case"top":_=(a?.top??0)-(s??0)-T,m=a?.left??0,p=y,h=u+(s??0)+_;break;case"bottom":_=(a?.bottom??0)+T,m=a?.left??0,p=y,h=u+(u-_);break;case"right":_=a?.top??0,m=(a?.right??0)+T,p=y-m,h=u;break;case"left":_=a?.top,m=(a?.left??0)-(Q??0)-T,p=m+(Q??0),h=u;break;default:_=(a?.top??0)-(s??0)-T,m=a?.left??0,p=y,h=u+(s??0)+_;break}(this.HTML_container?.offsetWidth??0)>=X*this.get_current_font_size()&&((this.HTML_container?.offsetWidth??0)<h?w=this.HTML_container?.offsetWidth??0:w=p),(this.HTML_container?.offsetHeight??0)>=U*this.get_current_font_size()&&((this.HTML_container?.offsetHeight??0)<h?L=this.HTML_container?.offsetHeight??0:L=h),this.apply_position_styles(h,p,L,w,_??0,m);let{top_correction:Z,left_correction:q,recalculate:ue,placement:ve}=this.check_screen_bounds(e,n);if(ue&&n<4)return this.positionate_container(ve,Z,q,n+1);_=(_??0)+Z,m=(m??0)+q,this.apply_position_styles(h,p,L,w,_,m)}apply_position_styles(e,t,i,n,a,s){this.HTML_container&&this.assign_styles_to_element(this.HTML_container,{"max-height":this.container_data?.max_height??`${e}px`,"max-width":this.container_data?.max_width??`${t}px`,"min-height":this.container_data?.min_height??`${i}px`,"min-width":this.container_data?.min_width??`${n}px`,top:`${a}px`,left:`${s}px`})}static \u0275fac=function(t){return new(t||c)(f(ae),f(ne),f(me),f(R))};static \u0275dir=ce({type:c,selectors:[["","generic-floating-container",""]],hostBindings:function(t,i){t&1&&F("click",function(a){return i.on_click(a)})("mouseenter",function(){return i.on_mouse_enter_host()})("mouseleave",function(){return i.on_mouse_leave_host()})},inputs:{_container_data:[0,"generic-floating-container","_container_data"]},outputs:{destroyed_emitter:"destroyed",mouse_enter_container_emitter:"mouse_enter_container",mouse_leave_container_emitter:"mouse_leave_container"}})};var O=class c{componente=S(void 0);set_componente(e){this.componente.update(t=>e)}get_componente(){return this.componente}static \u0275fac=function(t){return new(t||c)};static \u0275prov=H({token:c,factory:c.\u0275fac,providedIn:"root"})};var ye=["flotante1"],we=["flotante2"],Le=c=>({body_content:c,placement:"bottom",body_padding:"0px"}),Y=c=>({body_content:c,placement:"right",body_padding:"0px"});function Me(c,e){if(c&1&&(o(0,"ul",5)(1,"li",6)(2,"div",7)(3,"div",8),l(4,"Opci\xF3n 1"),r(),o(5,"div",9),d(6,"i",10),r()()(),o(7,"li",6)(8,"div",7)(9,"div",8),l(10,"Hacer otra cosa"),r(),o(11,"div",9),d(12,"i",11),r()()(),o(13,"li",12)(14,"div",7)(15,"div",8),l(16,"Opci\xF3n anidada"),r(),o(17,"div",9),d(18,"i",13),r()()(),o(19,"li",6)(20,"div",7)(21,"div",8),l(22,"Opci\xF3n ac0z102b123"),r(),o(23,"div",9),d(24,"i",14),r()()(),o(25,"li",6)(26,"div",7)(27,"div",8),l(28,"Opci\xF3n bd1a113c124"),r(),o(29,"div",9),d(30,"i",15),r()()(),o(31,"li",6)(32,"div",7)(33,"div",8),l(34,"Opci\xF3n ce2b124d125"),r(),o(35,"div",9),d(36,"i",16),r()()(),o(37,"li",6)(38,"div",7)(39,"div",8),l(40,"Opci\xF3n df3c135e126"),r(),o(41,"div",9),d(42,"i",17),r()()(),o(43,"li",6)(44,"div",7)(45,"div",8),l(46,"Opci\xF3n 1"),r(),o(47,"div",9),d(48,"i",10),r()()(),o(49,"li",6)(50,"div",7)(51,"div",8),l(52,"Hacer otra cosa"),r(),o(53,"div",9),d(54,"i",11),r()()(),o(55,"li",12)(56,"div",7)(57,"div",8),l(58,"Opci\xF3n anidada"),r(),o(59,"div",9),d(60,"i",13),r()()(),o(61,"li",6)(62,"div",7)(63,"div",8),l(64,"Opci\xF3n ac0z102b123"),r(),o(65,"div",9),d(66,"i",14),r()()(),o(67,"li",6)(68,"div",7)(69,"div",8),l(70,"Opci\xF3n bd1a113c124"),r(),o(71,"div",9),d(72,"i",15),r()()(),o(73,"li",6)(74,"div",7)(75,"div",8),l(76,"Opci\xF3n ce2b124d125"),r(),o(77,"div",9),d(78,"i",16),r()()(),o(79,"li",6)(80,"div",7)(81,"div",8),l(82,"Opci\xF3n df3c135e126"),r(),o(83,"div",9),d(84,"i",17),r()()()()),c&2){P();let t=x(7);v(13),g("generic-floating-container",b(2,Y,t)),v(42),g("generic-floating-container",b(4,Y,t))}}function De(c,e){if(c&1&&(o(0,"ul",18)(1,"li",6)(2,"div",7)(3,"div",8),l(4,"Hacer otra cosa"),r(),o(5,"div",9),d(6,"i",11),r()()(),o(7,"li",12)(8,"div",7)(9,"div",8),l(10,"Opci\xF3n anidada"),r(),o(11,"div",9),d(12,"i",13),r()()(),o(13,"li",6)(14,"div",7)(15,"div",8),l(16,"Opci\xF3n ac0z102b123"),r(),o(17,"div",9),d(18,"i",14),r()()()()),c&2){P();let t=x(5);v(7),g("generic-floating-container",b(1,Y,t))}}var fe=class c{constructor(e){this.header_service=e;this.titulo_componente=this.header_service.get_componente()}titulo_componente;titulo_string=S("LABORATORY");buttonTop=0;buttonLeft=0;offsetX=0;offsetY=0;onDragStart(e){if(e.target instanceof HTMLElement){let t=e.target.getBoundingClientRect();this.offsetX=e.clientX-t.left,this.offsetY=e.clientY-t.top,e.dataTransfer?.setData("text/plain","")}}onDragEnd(e){this.buttonTop=e.clientY-this.offsetY,this.buttonLeft=e.clientX-this.offsetX}content="Initial content from AppComponent";updateContent(){this.content=`AppComponent updated at ${new Date().toLocaleTimeString()}`,console.log(this.content)}floating_data={body_content:"hola"};flotante1;flotante2;algun_contenedor_con_mouse_dentro(){}static \u0275fac=function(t){return new(t||c)(f(O))};static \u0275cmp=se({type:c,selectors:[["csys-layout-publico"]],viewQuery:function(t,i){if(t&1&&(B(ye,5),B(we,5)),t&2){let n;G(n=j())&&(i.flotante1=n.first),G(n=j())&&(i.flotante2=n.first)}},decls:8,vars:7,consts:[["flotante1",""],["contenido",""],["contenido2",""],[1,"tw:w-[100vw]","tw:h-[200vh]"],["id","draggableButton","draggable","true",1,"btn","btn-primary","tw:cursor-move","tw:select-none","tw:absolute","tw:p-3","tw:rounded-lg",3,"dragstart","dragend","generic-floating-container"],[1,"list-group"],[1,"list-group-item","list-group-item-action"],[1,"row"],[1,"col-10"],[1,"col-2"],[1,"fas","fa-times"],[1,"fas","fa-circle"],[1,"list-group-item","list-group-item-action",3,"generic-floating-container"],[1,"fas","fa-caret-right"],[1,"fas","fa-check"],[1,"fas","fa-hashtag"],[1,"fas","fa-node"],[1,"fas","fa-js"],[1,"list-group","list-group-flush"]],template:function(t,i){if(t&1){let n=de();o(0,"div",3)(1,"button",4,0),F("dragstart",function(s){return N(n),z(i.onDragStart(s))})("dragend",function(s){return N(n),z(i.onDragEnd(s))}),l(3," Drag Me "),r()(),le(4,Me,85,6,"ng-template",null,1,V)(6,De,19,3,"ng-template",null,2,V)}if(t&2){let n=x(5);v(),_e("top",i.buttonTop,"px")("left",i.buttonLeft,"px"),g("generic-floating-container",b(5,Le,n))}},dependencies:[he,A],encapsulation:2})};export{fe as LayoutPublicoComponent};
